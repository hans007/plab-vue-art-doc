# 06-通讯安全

## 认证

- 考虑项目初期调试方便，采用 `Basic` 认证。
- 在 `http request header` 添加固定的 `access-token`。

## CORS

- 同域
- 开发服务器 - 完全开放 `allow *`
- 生产服务器 - 域名白名单

## RESTful API 风格

### http方法

- GET（SELECT）：从服务器取出资源（一项或多项）
- POST（CREATE）：在服务器新建一个资源
- PUT（UPDATE）：在服务器更新资源（客户端提供完整资源数据）
- PATCH（UPDATE）：在服务器更新资源（客户端提供需要修改的资源数据）
- DELETE（DELETE）：从服务器删除资源

### 常用的Response要包含的数据和状态码（status code）

- 当GET, PUT和PATCH请求成功时，要返回对应的数据，及状态码200，即SUCCESS
- 当POST创建数据成功时，要返回创建的数据，及状态码201，即CREATED
- 当DELETE删除数据成功时，不返回数据，状态码要返回204，即NO CONTENT
- 当GET 不到数据时，状态码要返回404，即NOT FOUND
- 任何时候，如果请求有问题，如校验请求数据时发现错误，要返回状态码 400，即BAD REQUEST
- 当API 请求需要用户认证时，如果request中的认证信息不正确，要返回状态码 401，即NOT AUTHORIZED
- 当API 请求需要验证用户权限时，如果当前用户无相应权限，要返回状态码 403，即FORBIDDEN
- http header 中的 Content-Type=application/json

## http错误处理

```
200: OK。一切正常。
201: 响应 POST 请求时成功创建一个资源。Location header 包含的URL指向新创建的资源。
204: 该请求被成功处理，响应不包含正文内容 (类似 DELETE 请求)。
304: 资源没有被修改。可以使用缓存的版本。
400: 错误的请求。可能通过用户方面的多种原因引起的，例如在请求体内有无效的JSON 数据，无效的操作参数，等等。
401: 验证失败。
403: 已经经过身份验证的用户不允许访问指定的 API 末端。
404: 所请求的资源不存在。
405: 不被允许的方法。 请检查 Allow header 允许的HTTP方法。
415: 不支持的媒体类型。 所请求的内容类型或版本号是无效的。
422: 数据验证失败 (例如，响应一个 POST 请求)。 请检查响应体内详细的错误消息。
429: 请求过多。 由于限速请求被拒绝。
500: 内部服务器错误。 这可能是由于内部程序错误引起的。
```

## 服务器程序异常错误处理

- 500情况，打印错误
- 如果服务器端 `try catch`，输出 `errMessage` 字段
